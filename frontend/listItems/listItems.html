<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lost Items | CampusFetch</title>
  <link rel="stylesheet" href="listItems.css">
</head>

<body>

<header>
  <h1>CampusFetch</h1>
  <p>Reported Lost Items</p>
</header>

<div class="container" id="items"></div>

<!-- Profile Button -->
<div id="profile-btn">
  <img src="../assets/profile.jpg" alt="Profile">
</div>

<!-- Profile Popup -->
<div id="profile-popup" class="hidden">
  <p><strong id="profileName">Vaishnavi</strong></p>
  <p id="profileEmail">vaishnavi.cs2021@abc.net</p>
  <span class="owner-badge">Owner</span>

  <hr>

  <button id="settingsBtn" class="settings-link">âš™ Settings</button>
</div>

<!-- Load items -->
<script type="module" src="listItems.js"></script>

<!-- Profile + Auth Logic -->
<script type="module">
  import { auth } from "../firebase.js";
  import { onAuthStateChanged }
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const profileBtn = document.getElementById("profile-btn");
  const popup = document.getElementById("profile-popup");
  const settingsBtn = document.getElementById("settingsBtn");
  const profileName = document.getElementById("profileName");
  const profileEmail = document.getElementById("profileEmail");

  profileBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    popup.classList.toggle("hidden");
  });

  popup.addEventListener("click", (e) => {
    e.stopPropagation();
  });

  document.addEventListener("click", () => {
    popup.classList.add("hidden");
  });

  settingsBtn.addEventListener("click", () => {
    const user = auth.currentUser;
    if (user) {
      window.location.href = "../settings/settings.html";
    } else {
      window.location.href = "../login/login.html?redirect=settings";
    }
  });

  onAuthStateChanged(auth, (user) => {
    if (user) {
      profileName.textContent = user.email.split("@")[0];
      profileEmail.textContent = user.email;
    }
  });
</script>

</body>
</html>
